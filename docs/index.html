<!DOCTYPE HTML>
<!--
	Escape Velocity by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Oakland Privacy Project</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	</head>
	<body class="homepage">
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header-wrapper" class="wrapper">
					<div id="header">

						<!-- Logo -->
							<div id="logo">
                                <img src="images/Asset%202.png" alt="" />
								<h1><a href="index.html">The Oakland Privacy Project</a></h1>
								<p>Your guide to government surveillance in the Bay Area</p>
							</div>

						<!-- Nav -->
							<nav id="nav">
								<ul>
									<li class="current"><a href="index.html">Home</a></li>
									<li>
										<a href="#">Technologies</a>
										<ul>
											<li><a href="#">Cell Site Simulators</a></li>
											<li><a href="#">Automatic License Plate Readers</a></li>
											<li><a href="#">Social Media Analytics</a></li>
											<li>
												<a href="#">Others</a>
												<ul>
													<li><a href="#">ShotSpotter</a></li>
													<li><a href="#">EZ-Pass</a></li>
													<li><a href="#">Smart Parking</a></li>
													<li><a href="#">Commercial Databases</a></li>
												</ul>
											</li>
										</ul>
									</li>
									<li><a href="left-sidebar.html">Get Involved</a></li>
									<li><a href="right-sidebar.html">Ordinances</a></li>
									<li><a href="no-sidebar.html">About</a></li>
								</ul>
							</nav>

					</div>
				</div>

			<!-- Intro -->
				<div id="intro-wrapper" class="wrapper style1">
					<div class="title">The Introduction</div>
					<section id="intro" class="container">
						<p class="style1">So in case you were wondering what this is all about ...</p>
						<p class="style2">
							Escape Velocity is a free responsive<br class="mobile-hide" />
							site template by <a href="http://html5up.net" class="nobr">HTML5 UP</a>
						</p>
						<p class="style3">It's <strong>responsive</strong>, built on <strong>HTML5</strong> and <strong>CSS3</strong>, and released for
						free under the <a href="http://html5up.net/license">Creative Commons Attribution 3.0 license</a>, so use it for any of
						your personal or commercial projects &ndash; just be sure to credit us!</p>
						<ul class="actions">
							<li><a href="#" class="button style3 big">Proceed</a></li>
						</ul>
					</section>
				</div>

			<!-- Main -->
				<div class="wrapper style2">
					<div class="title">The Details</div>
					<div id="main" class="container">

						<!-- Image -->
<script src="http://d3js.org/d3.v3.min.js"></script>
<link rel="stylesheet" href="./css/style.css"></link>
<script>
/*The functionality of this chart is derived from projects availble on bl.ocks.org.
Combining each of these pieces was somewhat complicated due to differences in
the individual design of each project.
The basic parallel coordinates chart, with brushing and axis dragging:
https://bl.ocks.org/mbostock/7586334 Mike Bostock
Line highlighting and tooltip:
http://bl.ocks.org/ABSegler/9791707  - AB Segler
Ordinal axis brushing:
http://bl.ocks.org/chrisbrich/4173826 - Chris Rich
Coloring and legend:
https://bl.ocks.org/YuanyuanZh/28897524626fa3f1d4c0 - Yuanyuan Zhang */

//definition of our workspace size
var margin = [50, 10, 10, 100],
    width = 1024 - margin[1] - margin[3],
    height = 600 - margin[0] - margin[2],
    height2 = height - 30;

//definitions to store what is being dragged
var x = d3.scale.ordinal().rangePoints([0, width], 1),
    y = {},
    dragging = {};

//chart elements
var line = d3.svg.line(),
    axis = d3.svg.axis().orient("left"),
    background,
    foreground;

//our tooltip definition
var tooltip = d3.select("body")
    .append("div")
    .style("position", "absolute")
    .style("z-index", "10")
    .style("visibility", "hidden")
    .text("a simple tooltip")
    .attr("class","tooltip");

//creating the workspace for our chart
var svg = d3.select("body").append("svg")
    .attr("width", width + margin[1] + margin[3])
    .attr("height", height + margin[0] + margin[2])
    .append("g")
    .attr("transform", "translate(" + margin[3] + "," + margin[0] + ")");

//colors of the chart lines by region
var color = { "Europe":"#54AF52",  "North America": "#DD6CA7", "Oceania": "#ff9f2f", "Africa": "#9D5130", 
              "Middle East":"#AB9C27", "South America": "#D58323", "Asia": "#5DA5B3"};

//defining which country belongs to which region (could be done better using a data file)
var group = { "Australia": "Oceania",
              "Austria": "Europe",
              "Belgium": "Europe",
              "Brazil": "South America",
              "Canada": "North America",
              "China": "Asia",
              "Denmark": "Europe",
              "Egypt": "Middle East",
              "Finland": "Europe",
              "France": "Europe",
              "Germany": "Europe",
              "Hong Kong": "Asia",
              "Israel": "Middle East",
              "Italy": "Europe",
              "Japan": "Asia",
              "Luxembourg": "Europe",
              "Netherlands": "Europe",
              "New Zealand": "Oceania",
              "Norway": "Europe",
              "Republic of Ireland": "Europe",
              "Russian Federation": "Europe",
              "Singapore": "Asia",
              "South Africa": "Africa",
              "South Korea": "Asia",
              "Spain": "Europe",
              "Sweden": "Europe",
              "Switzerland": "Europe",
              "Taiwan": "Asia",
              "Turkey": "Middle East",
              "United Kingdom": "Europe",
              "United States of America": "North America"
            };

//reading in the data for the school rankings
d3.csv("./data/timesData3.csv", function(error, data) {
  //if (error) throw error;
  // Extract the list of dimensions and create a scale for each.
  x.domain(dimensions = d3.keys(data[0]).filter(function(d) {
    //ordinal scale for our country list
    if (d == "country") { return y[d] = d3.scale.ordinal()
        .domain(data.map( function(p) { return p[d]; }).sort())
        .rangePoints([0, height2]);}
    //reverse the scale for our rankings (low numbers on top)
    if (d == "world_rank") { return y[d] = d3.scale.linear()
        .domain(d3.extent(data, function(p) { return +p[d]; }))
        .range([0, height2]);}

    //the rest of these are the same - maybe refactor into a function later
    if (d == "teaching") { return y[d] = d3.scale.linear()
        .domain(d3.extent(data, function(p) { return +p[d]; }))
        .range([height2, 0]);}

    if (d == "international_students") {return y[d] = d3.scale.linear()
        .domain(d3.extent(data, function(p) { return +p[d]; }))
        .range([height2, 0]);}

    if (d == "research") {return y[d] = d3.scale.linear()
        .domain(d3.extent(data, function(p) { return +p[d]; }))
        .range([height2, 0]);}

    if (d == "citations") {return y[d] = d3.scale.linear()
        .domain(d3.extent(data, function(p) { return +p[d]; }))
        .range([height2, 0]);}

    if (d == "income") { return y[d] = d3.scale.linear()
        .domain(d3.extent(data, function(p) { return +p[d]; }))
        .range([height2, 0]);}

    return false;
  }));
    
  // Add grey background lines for context.
  background = svg.append("g")
      .attr("class", "background")
      .selectAll("path")
      .data(data)
      .enter().append("path")
      .attr("d", path);

  //Foreground lines will appear when selected data is brushed
  //if a mouse is over a line, it will display a tooltip
  foreground = svg.append("g")
    .attr("class", "foreground")
    .selectAll("path")
    .data(data)
    .enter().append("path")
    .attr("d", path)
    //mouse over functions
    .on("mouseover", mouseover)
    .on("mousemove", function(){
        return tooltip.style("top", (event.pageY-10)+"px").style("left",(event.pageX+10)+"px");})
    .on("mouseout", mouseout)
    //determine the color by looking up the regional group of a country and then its color
    .attr({'style': function(d) {
          return "stroke: " + color[group[d.country]];
     }});
    
  // this is the functionality for axis dragging
  var g = svg.selectAll(".dimension")
      .data(dimensions)
      .enter().append("g")
      .attr("class", "dimension")
      .attr("transform", function(d) { return "translate(" + x(d) + ")"; })
      .call(d3.behavior.drag()
        .on("dragstart", function(d) {
          dragging[d] = this.__origin__ = x(d);
          background.attr("visibility", "hidden");
        })
        .on("drag", function(d) {
          dragging[d] = Math.min(width, Math.max(0, this.__origin__ += d3.event.dx));
          foreground.attr("d", path);
          dimensions.sort(function(a, b) { return position(a) - position(b); });
          x.domain(dimensions);
          g.attr("transform", function(d) { return "translate(" + position(d) + ")"; })
        })
        .on("dragend", function(d) {
          delete this.__origin__;
          delete dragging[d];
          transition(d3.select(this)).attr("transform", "translate(" + x(d) + ")");
          transition(foreground)
              .attr("d", path);
          background
              .attr("d", path)
              .transition()
              .delay(500)
              .duration(0)
              .attr("visibility", null);
        }));

  // Add an axis and title.
  g.append("g")
      .attr("class", "axis")
      .each(function(d) { d3.select(this).call(axis.scale(y[d])); })
      .append("text")
      .attr("text-anchor", "middle")
      .attr("y", -9)
      .text(String);

  // Add and store a brush for each axis.
  g.append("g")
      .attr("class", "brush")
      .each(function(d) { 
            d3.select(this)
                .call(y[d].brush = d3.svg.brush().y(y[d])
                .on("brushstart", brushstart)
                .on("brush", brush)); })
      .selectAll("rect")
      .attr("x", -8)
      .attr("width", 16);
    
  //create the legend
  var legend = svg.append('g')
      .attr("width", 60)
      .attr("height", 10)
      .attr('stroke', '#555')
      .attr("transform", "translate("+100+", "+ height + ")");
  //function to draw the legend elements
  var newLegend = function(legendContainer, color, text, offsetX) {
    var g = legendContainer.append('g');
    if (offsetX) {
        g.attr("transform", "translate(" + offsetX + ", 0)");
    }
    g.append('text')
      .style({'font-size': '8px', 'stroke': color, 'fill': color})
      .text('██');
    g.append('text')
      .attr("transform", "translate(20, 0)")
      .attr('fill', '#000')
      .text(text);
  };
  //loops through each color group and calls a legend element to be drawn
  var value;
  var i = 0;
 //http://stackoverflow.com/questions/33946567/javascript-iterate-over-values-of-map
  Object.keys(color).forEach(function(key) {
      value = color[key];
      newLegend(legend, value, key, i*100);
      i++;
  });
});

//on mouseover of a line, highlight the selected line and display a tooltip
function mouseover(d) {
    svg.classed("active", true);
    foreground.classed("inactive", function(p) { return p !== d; });
    foreground.classed("highlight", function(p) { return p === d; });
    foreground.filter(function(p) { return p === d; }).each(moveToFront);
    tooltip.text("#"+d.world_rank+": "+d.university_name+" ("+d.year+")");
    return tooltip.style("visibility", "visible");
}

//when a mouse is not over a line, display all lines normally
//and hide the tooltip
function mouseout(d) {      
    svg.classed("active", false);
    foreground.classed("inactive", false);
    foreground.classed("highlight", false);
    return tooltip.style("visibility", "hidden");
}

//also, make sure the highlighted line is displayed on top of
//all the other lines
function moveToFront() {
    this.parentNode.appendChild(this);
}
    
//used to get position of dragged axes    
function position(d) {
  var v = dragging[d];
  return v == null ? x(d) : v;
}

//animation for the dragging of axes
function transition(g) {
  return g.transition().duration(500);
}

// Returns the path for a given data point.
function path(d) {
  return line(dimensions.map(function(p) { return [position(p), y[p](d[p])]; }));
}

// When brushing, don’t trigger axis dragging.
function brushstart() {
  d3.event.sourceEvent.stopPropagation();
}

// Handles a brush event, toggling the display of foreground lines.
//this part is tricky as you need to convert the ordinal axes to pixel range
function brush() {
  var actives = dimensions.filter(function(p) { return !y[p].brush.empty(); }),
      extents = actives.map(function(p) { 
              return y[p].brush.extent();
      });
  foreground.style("display", function(d) {
    return actives.every(function(p, i) {
        var p_new = (y[p].ticks)?d[p]:y[p](d[p]); //convert to pixel range if ordinal
          return extents[i][0] <= p_new && p_new <= extents[i][1];
    }) ? null : "none";
  });
}

</script>

						<!-- Features -->
							<section id="features">
								<header class="style1">
									<h2>Dolor consequat feugiat amet veroeros</h2>
									<p>Feugiat dolor nullam orci pretium phasellus justo</p>
								</header> 
								<div class="feature-list">
									<div class="row">
										<div class="6u 12u(mobile)">
											<section>
												<h3 class="icon fa-comment">Mattis velit diam vulputate</h3>
												<p>Eget mattis at, laoreet vel et velit aliquam diam ante, aliquet sit amet vulputate. Eget mattis at, laoreet vel velit lorem.</p>
											</section>
										</div>
										<div class="6u 12u(mobile)">
											<section>
												<h3 class="icon fa-refresh">Lorem ipsum dolor sit veroeros</h3>
												<p>Eget mattis at, laoreet vel et velit aliquam diam ante, aliquet sit amet vulputate. Eget mattis at, laoreet vel velit lorem.</p>
											</section>
										</div>
									</div>
									<div class="row">
										<div class="6u 12u(mobile)">
											<section>
												<h3 class="icon fa-picture-o">Pretium phasellus justo lorem</h3>
												<p>Eget mattis at, laoreet vel et velit aliquam diam ante, aliquet sit amet vulputate. Eget mattis at, laoreet vel velit lorem.</p>
											</section>
										</div>
										<div class="6u 12u(mobile)">
											<section>
												<h3 class="icon fa-cog">Tempus sed pretium orci</h3>
												<p>Eget mattis at, laoreet vel et velit aliquam diam ante, aliquet sit amet vulputate. Eget mattis at, laoreet vel velit lorem.</p>
											</section>
										</div>
									</div>
									<div class="row">
										<div class="6u 12u(mobile)">
											<section>
												<h3 class="icon fa-wrench">Aliquam consequat et feugiat</h3>
												<p>Eget mattis at, laoreet vel et velit aliquam diam ante, aliquet sit amet vulputate. Eget mattis at, laoreet vel velit lorem.</p>
											</section>
										</div>
										<div class="6u 12u(mobile)">
											<section>
												<h3 class="icon fa-check">Dolore laoreet aliquam mattis</h3>
												<p>Eget mattis at, laoreet vel et velit aliquam diam ante, aliquet sit amet vulputate. Eget mattis at, laoreet vel velit lorem.</p>
											</section>
										</div>
									</div>
								</div>
								<ul class="actions actions-centered">
									<li><a href="#" class="button style1 big">Get Started</a></li>
									<li><a href="#" class="button style2 big">More Info</a></li>
								</ul>
							</section>

					</div>
				</div>

			<!-- Highlights -->
				<div class="wrapper style3">
					<div class="title">The Endorsements</div>
					<div id="highlights" class="container">
						<div class="row 150%">
							<div class="4u 12u(mobile)">
								<section class="highlight">
									<a href="#" class="image featured"><img src="images/pic02.jpg" alt="" /></a>
									<h3><a href="#">Aliquam diam consequat</a></h3>
									<p>Eget mattis at, laoreet vel amet sed velit aliquam diam ante, dolor aliquet sit amet vulputate mattis amet laoreet lorem.</p>
									<ul class="actions">
										<li><a href="#" class="button style1">Learn More</a></li>
									</ul>
								</section>
							</div>
							<div class="4u 12u(mobile)">
								<section class="highlight">
									<a href="#" class="image featured"><img src="images/pic03.jpg" alt="" /></a>
									<h3><a href="#">Nisl adipiscing sed lorem</a></h3>
									<p>Eget mattis at, laoreet vel amet sed velit aliquam diam ante, dolor aliquet sit amet vulputate mattis amet laoreet lorem.</p>
									<ul class="actions">
										<li><a href="#" class="button style1">Learn More</a></li>
									</ul>
								</section>
							</div>
							<div class="4u 12u(mobile)">
								<section class="highlight">
									<a href="#" class="image featured"><img src="images/pic04.jpg" alt="" /></a>
									<h3><a href="#">Mattis tempus lorem</a></h3>
									<p>Eget mattis at, laoreet vel amet sed velit aliquam diam ante, dolor aliquet sit amet vulputate mattis amet laoreet lorem.</p>
									<ul class="actions">
										<li><a href="#" class="button style1">Learn More</a></li>
									</ul>
								</section>
							</div>
						</div>
					</div>
				</div>

			<!-- Footer -->
				<div id="footer-wrapper" class="wrapper">
					<div class="title">The Rest Of It</div>
					<div id="footer" class="container">
						<header class="style1">
							<h2>Ipsum sapien elementum portitor?</h2>
							<p>
								Sed turpis tortor, tincidunt sed ornare in metus porttitor mollis nunc in aliquet.<br />
								Nam pharetra laoreet imperdiet volutpat etiam consequat feugiat.
							</p>
						</header>
						<hr />
						<div class="row 150%">
							<div class="6u 12u(mobile)">

								<!-- Contact Form -->
									<section>
										<form method="post" action="#">
											<div class="row 50%">
												<div class="6u 12u(mobile)">
													<input type="text" name="name" id="contact-name" placeholder="Name" />
												</div>
												<div class="6u 12u(mobile)">
													<input type="text" name="email" id="contact-email" placeholder="Email" />
												</div>
											</div>
											<div class="row 50%">
												<div class="12u">
													<textarea name="message" id="contact-message" placeholder="Message" rows="4"></textarea>
												</div>
											</div>
											<div class="row">
												<div class="12u">
													<ul class="actions">
														<li><input type="submit" class="style1" value="Send" /></li>
														<li><input type="reset" class="style2" value="Reset" /></li>
													</ul>
												</div>
											</div>
										</form>
									</section>

							</div>
							<div class="6u 12u(mobile)">

								<!-- Contact -->
									<section class="feature-list small">
										<div class="row">
											<div class="6u 12u(mobile)">
												<section>
													<h3 class="icon fa-comment">Contact</h3>
													<p>
														<a href="#">@stevetrush</a><br />
													</p>
												</section>
											</div>
										</div>
										<div class="row">
											<div class="6u 12u(mobile)">
												<section>
													<h3 class="icon fa-envelope">Email</h3>
													<p>
														<a href="#">strush@berkeley.edu</a>
													</p>
												</section>
											</div>
										</div>
									</section>

							</div>
						</div>
						<hr />
					</div>
					<div id="copyright">
						<ul>
							<li>&copy; Steve Trush</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</div>
				</div>

		</div>

		<!-- Scripts -->

			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/skel-viewport.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>