<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=IE8">
    <meta name="description" content="Privacy to the Max">
    <meta name="keywords" content="Privacy to the Max">
    <meta name="viewport" content="width=540, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="google" content="notranslate">
    <title>Privacy to the Max</title>
    <script type="text/javascript">var version = '1.9.5';</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/style.css" rel="stylesheet">
<link href="color/default.css" rel="stylesheet">
<link rel="shortcut icon" href="img/favicon.ico">
<link rel="stylesheet1" href="css/font-awesome.css">

<script src="js/jquery.js"></script>
<script src="js/jquery.scrollTo.js"></script>
<script src="js/jquery.nav.js"></script>
<script src="js/jquery.localscroll-1.2.7-min.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/jquery.prettyPhoto.js"></script>
<script src="js/isotope.js"></script>
<script src="js/jquery.flexslider.js"></script>
<script src="js/inview.js"></script>
<script src="js/animate.js"></script>
<script src="js/validate.js"></script>
<script src="js/custom.js"></script>   
<script type="text/javascript">var version = '1.9.5';</script>
<!--[if gte IE 9]><!-->
<script type="text/javascript" src="d3.min.js?1.9.5"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<script type="text/javascript" src="koala.js?1.9.5"></script>
<!--<![endif]-->
<link rel="stylesheet3" type="text/css" href="koala.css?1.9.5"/>
<link rel="stylesheet2" type="text/css" href="sankey.css">
<script src="d3.v3.min.js"></script>
<script type="text/javascript" src="alluvial-growth.js"></script>
<script type="text/javascript" src="https://cdn.rawgit.com/Caged/d3-tip/master/index.js"></script>

<!-- =======================================================
    Theme Name: Maxim
    Theme URL: https://bootstrapmade.com/maxim-free-onepage-bootstrap-theme/
    Author: BootstrapMade.com
    Author URL: https://bootstrapmade.com
======================================================= -->
</head>
<body>
<!-- navbar -->
<div class="navbar-wrapper">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<div class="container">
				<!-- Responsive navbar -->
				<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</a>
				<h1 class="brand"><a href="index.html">Stinkray</a></h1>
				<!-- navigation -->
				<nav class="pull-right nav-collapse collapse">
				<ul id="menu-main" class="nav">
					<li><a title="team" href="#about">About</a></li>
					<li><a title="services" href="#services">Services</a></li>
					<li><a title="works" href="#works">Works</a></li>
					<li><a title="blog" href="#blog">Blog</a></li>
					<li><a title="contact" href="#contact">Contact</a></li>
					<li><a href="page.html">Page</a></li>
				</ul>
				</nav>
			</div>
		</div>
	</div>
</div>
<!-- Header area -->
<div id="header-wrapper" class="header-slider">
	<header class="clearfix">
	<div class="logo">
		<img src="img/stingray-small.png" alt="stinkray" />
	</div>
	<div class="container">
		<div class="row">
			<div class="span12">
				<div id="main-flexslider" class="flexslider">
					<ul class="slides">
						<li>
						<p class="home-slide-content">
							<strong>STINK</strong> Ray
						</p>
						</li>
						<li>
						<p class="home-slide-content">
							Surveillance is <strong>NOW</strong>
						</p>
						</li>
						<li>
						<p class="home-slide-content">
							Hide <strong>yourshelfs</strong>
						</p>
						</li>
					</ul>
				</div>
				<!-- end slider -->
			</div>
		</div>
	</div>
	</header>
</div>
<!-- section: contact -->
<section id="contact" class="section">
<div class="container">
	<h4>Tell us a little about yourself!</h4>
	<p>
		 In order to assess your surveillance score, we'd like to know a little about your background. lita prompta et mel vidisse phaedrum pri et. Facilisis posidonium ex his. Mutat iudico vis in, mea aeque tamquam scripserit an, mea eu ignota viderer probatus. Lorem legere consetetur ei eum. Sumo aeque assentior te eam, pri nominati posidonium consttuam
	</p>
	<div class="blankdivider30">
	</div>
	<div class="row">
		<div class="span12">
			<div class="cform" id="contact-form">
				<div id="sendmessage">Your message has been sent. Thank you!</div>
                <div id="errormessage"></div>
				<form action="" method="post" role="form" class="contactForm">
					<div class="row">
						<div class="span6">
							<!-- Cell phone button -->
							<div class="field form-group">
							  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							    Do you use a cell phone? <span class="caret"></span>
							  </button>
							  <ul class="dropdown-menu">
							    <li><a href="#">Yes</a></li>
							    <li><a href="#">No</a></li>
							  </ul>
							</div>
							<!-- Car button -->
							<div class="field form-group">
                                    Income Level?<input type="range" min="1" max="5" id="IncLevel" value ="1">
							</div>							
                            <div class="field form-group">
                                    Social Media Use?<input type="range" min="1" max="5" id="SMULevel" value ="1">
							</div>
							<div class="field form-group">
							  Do you own a car? <select id="CarUse" class="btn btn-default dropdown-toggle" aria-expanded="false" onChange="koala.updateData()">
							     <span class="caret"></span>
							  <ul class="dropdown-menu">
							    <li><option value="yes">Yes, I use it daily</option></li>
							    <li><option value="maybe">Yes, I use it sometimes</option></li>
							    <li><option value="no">No</option></li>
							  </ul>
                              </select>
							</div>
							<!-- Public Transit button -->
							<div class="field form-group">
							  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							    Do you use public transit? <span class="caret"></span>
							  </button>
							  <ul class="dropdown-menu">
							    <li><a href="#">Yes, I use it daily</a></li>
							    <li><a href="#">Yes, I use it sometimes</a></li>
							    <li><a href="#">No</a></li>
							  </ul>
							</div>
							<!-- Public Events button -->
							<div class="field form-group">
							  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							    How often do you attend public events?  <span class="caret"></span>
							  </button>
							  <ul class="dropdown-menu">
							    <li><a href="#">Weekly</a></li>
							    <li><a href="#">Monthly</a></li>
							    <li><a href="#">Sometimes</a></li>
							    <li><a href="#">Never</a></li>
							  </ul>
							</div>
							<!-- Income button -->
							<div class="field form-group">
							  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							    What is your income bracket?  <span class="caret"></span>
							  </button>
							  <ul class="dropdown-menu">
							    <li><a href="#">Low</a></li>
							    <li><a href="#">Low-Medium</a></li>
							    <li><a href="#">Medium</a></li>
							    <li><a href="#">High-Medium</a></li>
							    <li><a href="#">High</a></li>
							  </ul>
							</div>
							<!-- Income button -->
							<div class="field form-group">
							  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							    How important is Social Media to you?  <span class="caret"></span>
							  </button>
							  <ul class="dropdown-menu">
							    <li><a href="#">I use it daily - it is essential for my social life or business</a></li>
							    <li><a href="#">I use it often - it is not essential for my social life or business</a></li>
							    <li><a href="#">I use it occasionally</a></li>
							    <li><a href="#">I do not use any social media</a></li>
							  </ul>
							</div>
							<!--name-->
<!-- 							<div class="field your-name form-group">
								<input type="text" name="name" class="form-control" id="name" placeholder="Your Name" data-rule="minlen:4" data-msg="Please enter at least 4 chars" />
                                <div class="validation"></div>
							</div>
							<div class="field your-email form-group">
								<input type="text" class="form-control" name="email" id="email" placeholder="Your Email" data-rule="email" data-msg="Please enter a valid email" />
                                <div class="validation"></div>
							</div>
							<div class="field subject form-group">
								<input type="text" class="form-control" name="subject" id="subject" placeholder="Subject" data-rule="minlen:4" data-msg="Please enter at least 8 chars of subject" />
                                <div class="validation"></div>
							</div> -->
						</div>
						<!-- Put the image here? -->
						<div class="span6">
							<div id="dots"></div>
						</div>
					</div>
				</form>
			</div>
		</div>
		<!-- ./span12 -->
	</div>
</div>
</section>

<!-- section: team -->
<section id="about" class="section">
<div class="container">
	<h4>About the project</h4>
	<div class="row">
		<div class="span4 offset1">
			<div>
				<h2>We are <strong>being surveilled</strong></h2>
				<p>
					Li Europan lingues es membres del sam familie. Lor separat existentie es un myth. Por scientie, musica, sport etc, litot Europa usa li sam vocabular. Li lingues differe solmen in li grammatica, li pronunciation e li plu commun vocabules. Omnicos directe al desirabilite de un nov lingua franca: On refusa continuar payar custosi traductores.
				</p>
			</div>
		</div>
		<div class="span6">
			<div class="aligncenter">
				<img src="img/icons/creativity.png" alt="" />
			</div>
		</div>
	</div>
	<div class="row">
		<div class="span2 offset1 flyIn">
			<div class="people">
				<img class="team-thumb img-circle" src="img/team/img-1.jpg" alt="" />
				<h3>John Doe</h3>
				<p>
					Art director
				</p>
			</div>
		</div>
		<div class="span2 flyIn">
			<div class="people">
				<img class="team-thumb img-circle" src="img/team/img-2.jpg" alt="" />
				<h3>Mike Doe</h3>
				<p>
					Web developer
				</p>
			</div>
		</div>
		<div class="span2 flyIn">
			<div class="people">
				<img class="team-thumb img-circle" src="img/team/img-3.jpg" alt="" />
				<h3>Neil Doe</h3>
				<p>
					Web designer
				</p>
			</div>
		</div>
		<div class="span2 flyIn">
			<div class="people">
				<img class="team-thumb img-circle" src="img/team/img-4.jpg" alt="" />
				<h3>Mark Joe</h3>
				<p>
					UI designer
				</p>
			</div>
		</div>
		<div class="span2 flyIn">
			<div class="people">
				<img class="team-thumb img-circle" src="img/team/img-5.jpg" alt="" />
				<h3>Stephen B</h3>
				<p>
					Digital imaging
				</p>
			</div>
		</div>
	</div>
</div>
<!-- /.container -->
</section>
<!-- end section: team -->
<!-- spacer section -->
<section class="spacer green">
<div class="container">
	<div class="row">
		<div class="span6 alignright flyLeft">
			<blockquote class="large">
				 This is where a quote from the interview goes <cite>Ray Sting, Concerned Citizen</cite>
			</blockquote>
		</div>
		<div class="span6 aligncenter flyRight">
			<i class="icon-coffee icon-10x"></i>
		</div>
	</div>
</div>
</section>
<!-- end spacer section -->
<!-- section: services -->
<section id="services" class="section orange">
<div class="container">
	<div class="row">
	<!-- Four columns -->
        <div class="election-wrapper">
            <div id="sankey"></div>
            <p>Technology Information:</p>
            <div id="techinfo" class="text" style="display:none;">
            <p>Blah Blah Blah.</p>
            </div>
        </div>
    </div>
</div>
</section>
<!-- end section: services -->
<!-- section: works -->
<section id="works" class="section">
<div class="container clearfix">
	<h4>Our Works</h4>
	<!-- portfolio filter -->
	<div class="row">
		<div id="filters" class="span12">
			<ul class="clearfix">
				<li><a href="#" data-filter="*" class="active">
				<h5>All</h5>
				</a></li>
				<li><a href="#" data-filter=".web">
				<h5>Web</h5>
				</a></li>
				<li><a href="#" data-filter=".print">
				<h5>Print</h5>
				</a></li>
				<li><a href="#" data-filter=".design">
				<h5>Design</h5>
				</a></li>
				<li><a href="#" data-filter=".photography">
				<h5>Photography</h5>
				</a></li>
			</ul>
		</div>
		<!-- END PORTFOLIO FILTERING -->
	</div>
	<div class="row">
		<div class="span12">
			<div id="portfolio-wrap">
				<!-- portfolio item -->
				<div class="portfolio-item grid print photography">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/1.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid print design web">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/2.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid print design">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/3.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid photography web">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/4.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid photography web">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/5.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid photography web">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/6.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid photography web">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/7.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid photography">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/8.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid photography web">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/9.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
				<!-- portfolio item -->
				<div class="portfolio-item grid design web">
					<div class="portfolio">
						<a href="img/works/big.jpg" data-pretty="prettyPhoto[gallery1]" class="portfolio-image">
						<img src="img/works/10.png" alt="" />
						<div class="portfolio-overlay">
							<div class="thumb-info">
								<h5>Portfolio name</h5>
								<i class="icon-plus icon-2x"></i>
							</div>
						</div>
						</a>
					</div>
				</div>
				<!-- end portfolio item -->
			</div>
		</div>
	</div>
</div>
</section>
<!-- spacer section -->
<section class="spacer bg3">
<div class="container">
	<div class="row">
		<div class="span12 aligncenter flyLeft">
			<blockquote class="large">
				 We are an established and trusted web agency with a reputation for commitment and high integrity
			</blockquote>
		</div>
		<div class="span12 aligncenter flyRight">
			<i class="icon-rocket icon-10x"></i>
		</div>
	</div>
</div>
</section>
<!-- end spacer section -->
<!-- section: blog -->
<section id="blog" class="section">
<div class="container">
	<h4>Our Blog</h4>
	<!-- Three columns -->
	<div class="row">
		<div class="span3">
			<div class="home-post">
				<div class="post-image">
					<img class="max-img" src="img/blog/img1.jpg" alt="" />
				</div>
				<div class="post-meta">
					<i class="icon-file icon-2x"></i>
					<span class="date">June 19, 2013</span>
					<span class="tags"><a href="#">Design</a>, <a href="#">Blog</a></span>
				</div>
				<div class="entry-content">
					<h5><strong><a href="#">New design trends</a></strong></h5>
					<p>
						Lorem Ipsum is simply dummy text of the printing and typesetting industry. &hellip;
					</p>
					<a href="#" class="more">Read more</a>
				</div>
			</div>
		</div>
		<div class="span3">
			<div class="home-post">
				<div class="post-image">
					<img class="max-img" src="img/blog/img2.jpg" alt="" />
				</div>
				<div class="post-meta">
					<i class="icon-file icon-2x"></i>
					<span class="date">June 19, 2013</span>
					<span class="tags"><a href="#">Design</a>, <a href="#">News</a></span>
				</div>
				<div class="entry-content">
					<h5><strong><a href="#">Retro is great</a></strong></h5>
					<p>
						Lorem Ipsum is simply dummy text of the printing and typesetting industry. &hellip;
					</p>
					<a href="#" class="more">Read more</a>
				</div>
			</div>
		</div>
		<div class="span3">
			<div class="home-post">
				<div class="post-image">
					<img class="max-img" src="img/blog/img3.jpg" alt="" />
				</div>
				<div class="post-meta">
					<i class="icon-file icon-2x"></i>
					<span class="date">June 22, 2013</span>
					<span class="tags"><a href="#">Design</a>, <a href="#">Tips</a></span>
				</div>
				<div class="entry-content">
					<h5><strong><a href="#">Isometric mockup</a></strong></h5>
					<p>
						Lorem Ipsum is simply dummy text of the printing and typesetting industry. &hellip;
					</p>
					<a href="#" class="more">Read more</a>
				</div>
			</div>
		</div>
		<div class="span3">
			<div class="home-post">
				<div class="post-image">
					<img class="max-img" src="img/blog/img4.jpg" alt="" />
				</div>
				<div class="post-meta">
					<i class="icon-file icon-2x"></i>
					<span class="date">June 27, 2013</span>
					<span class="tags"><a href="#">News</a>, <a href="#">Tutorial</a></span>
				</div>
				<div class="entry-content">
					<h5><strong><a href="#">Free icon set</a></strong></h5>
					<p>
						Lorem Ipsum is simply dummy text of the printing and typesetting industry. &hellip;
					</p>
					<a href="#" class="more">Read more</a>
				</div>
			</div>
		</div>
	</div>
	<div class="blankdivider30"></div>
	<div class="aligncenter">
		<a href="#" class="btn btn-large btn-theme">More blog post</a>
	</div>
</div>
</section>

<!-- end spacer section -->

<footer>
<div class="container">
	<div class="row">
		<div class="span6 offset3">
			<ul class="social-networks">
				<li><a href="#"><i class="icon-circled icon-bgdark icon-instagram icon-2x"></i></a></li>
				<li><a href="#"><i class="icon-circled icon-bgdark icon-twitter icon-2x"></i></a></li>
				<li><a href="#"><i class="icon-circled icon-bgdark icon-dribbble icon-2x"></i></a></li>
				<li><a href="#"><i class="icon-circled icon-bgdark icon-pinterest icon-2x"></i></a></li>
			</ul>
			<p class="copyright">
				&copy; Maxim Theme. All rights reserved.
                <div class="credits">
                    <!-- 
                        All the links in the footer should remain intact. 
                        You can delete the links only if you purchased the pro version.
                        Licensing information: https://bootstrapmade.com/license/
                        Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=Maxim
                    -->
                    <a href="https://bootstrapmade.com/">Free Bootstrap Themes</a> by BootstrapMade.com
                </div>
			</p>
		</div>
	</div>
</div>
<!-- ./container -->
</footer>
<a href="#" class="scrollup"><i class="icon-angle-up icon-square icon-bgdark icon-2x"></i></a>
<!-->
    
   <!--[if gte IE 9]><!-->
    <script type="text/javascript">
      // Code left intentionally unminimized for your reading pleasure.

    function newImage(num) {
        var element = document.getElementById("dots");
        while (element.firstChild) {
            element.removeChild(element.firstChild);
        }
        window.shownFile = 'none';
        var koala = run_persona(true);

        // If an error happens I want to know about it!
        window.onerror = function(msg, url, ln) {
          msg = msg.toString();
          // In Chrome and Firefox an error on a script form a foreign domain will cause this, see link bellow:
          // http://stackoverflow.com/questions/5913978/cryptic-script-error-reported-in-javascript-in-chrome-and-firefox
          if (msg === 'Script error.' && url === '' && ln === 0) return;
          // Track only one error per page load
          window.onerror = function() {};
        };

        // First, make sure we can run.
        if (!koala.supportsCanvas()) {
          alert("Sorry, KoalsToTheMax needs HTML5 Canvas support which your browser does not have. Supported browsers include Chrome, Safari, Firefox, Opera, and Internet Explorer 9, 10");
          return;
        }

        if (!koala.supportsSVG()) {
          alert("Sorry, KoalsToTheMax needs SVG support which your browser does not have. Supported browsers include Chrome, Safari, Firefox, Opera, and Internet Explorer 9, 10");
          return;
        }

        // This is strange, track it if it happens.
        if (!window.d3) {
          alert("Some how D3 was not loaded so the site can not start. This is bad... We are investigating. Try refreshing the page and see if that helps.");
          return;
        }

          function basicLoad(location) {
            var possible = ['persona'+num];
            var file = 'img/' + possible[Math.floor(Math.random() * possible.length)] + '.jpg'
            return {
              file: file,
              shownFile: location.protocol + '//' + location.host + location.pathname + file
            };
          }

          function parseUrl(location) {
            // Fall though
            return basicLoad(location);
          }

          var parse = parseUrl(location);
          if (!parse) return;
          var file = parse.file;
          window.shownFile = parse.shownFile;

          if (parse.background) {
            d3.select(document.body)
              .style('background', parse.background);
          }
          if (parse.hideNote) {
            d3.select('#footer')
              .style('display', 'none');
          }

          var img = new Image();
          
          img.onload = function() {
            var colorData;
            try {
              colorData = koala.loadImage(this);
            } catch (e) {
              colorData = null;
              alert("Sorry, KoalaToTheMax could not load the image '" + file + "'");
              setTimeout(function() {
                window.location.href = domain;
              }, 750);
            }
            console.log("Loooad!!!!");
            if (colorData) {
              koala.makeCircles("#dots", colorData, null);
              console.log("Loooad!2222!!!");
              koala.loadProfileData(1)
              console.log("Loooad!3333!!!");
              //track('GoodLoad', 'Yay');
            }
          };
          img.src = file;
      };
    newImage(1);
    </script>

<script>
  var units = "USD",
      linkTooltipOffset = 62,
      nodeTooltipOffset = 130,
      technologies = ["Stingray", "ALPR", "ShotSpotter","CCTV and Public Transit", 
              "Social Media Monitoring"];

  var margin = {top: 10, right: 10, bottom: 10, left: 10},
      width = 800 - margin.left - margin.right,
      height = 450 - margin.top - margin.bottom;

  /* Initialize tooltip */
  var tipLinks = d3.tip()
      .attr('class', 'd3-tip')
      .offset([-10,0]);

  var tipNodes = d3.tip()
      .attr('class', 'd3-tip d3-tip-nodes')
      .offset([-10, 0]);

  function formatAmount(val) {
      return val.toLocaleString("en-US", {style: 'currency', currency: "USD"}).replace(/\.[0-9]+/, "");
  };

  // append the svg canvas to the page
  var svg = d3.select("#sankey").append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .attr("class", "sankey")
      .call(tipLinks)
      .call(tipNodes)
    .append("g")
      .attr("transform", 
            "translate(" + margin.left + "," + margin.top + ")");

  // Set the sankey diagram properties
  var sankey = d3.alluvialGrowth()
      .nodeWidth(36)
      .nodePadding(14)
      .size([width, height]);

  var path = sankey.link();
  var alpr_link = 1;
  var tech_more;
  d3.json("survey.json", function(data) {
    tech_more = data.scores.tech;
  });
    
var tech_data = {
    "Stingray": {
        in_score : 1,
        out_score : 1,
        image : "img/stingray.png",
        bio : "<p>Blah Blah Blah Stung.</p>",
        color : "#54AF52",
        speed : "20s",
        short : "stingray"
    },  
    "ALPR": {
        in_score : 1,
        out_score : 1,
        image : "img/alpr1.jpg",
        bio : "<p>Blah Blah Blah Beep.</p>",
        color : "#DD6CA7",
        speed : "4s",
        short : "alpr"
    }, 
    "ShotSpotter": {
        in_score : 1,
        out_score : 1,
        image : "img/shotspotter.jpg",
        bio : "<p>Blah Blah Blah Bang.</p>",
        color : "#ff9f2f",
        speed : "17s",
        short : "shotspotter"
    }, 
    "CCTV and Public Transit": {
        in_score : 1,
        out_score : 1,
        image : "img/cctv.jpg",
        bio : "<p>Blah Blah Blah Bus.</p>",
        color : "#9D5130",
        speed : "3s",
        short : "cctv"
    }, 
    "Social Media Monitoring": {
        in_score : 1,
        out_score : 1,
        image : "img/socialmedia.jpg",
        bio : "<p>Blah Blah Blah Tweet.</p>",
        color : "#AB9C27",
        speed : "8s",
        short : "smm"
    }};
    
  var category_data = {
      "Where You Go": {
          in_score : 1,
      },
      "Who You Know": {
          in_score : 1,
      },
      "What You Say": {
          in_score : 1,
      },
      "What You Do": {
          in_score : 1,
      }
  };
    
  var agency_data = {
      "Oakland Police": {
          out_score : 1,
      },
      "Alameda County Sheriff": {
          out_score : 1,
      },
      "FBI": {
          out_score : 1,
      },
      "DHS": {
          out_score : 1,
      }
  };

    
  d3.csv("scores.csv", function(error, data) {

    var currentData = data;

    function processData(data, init) {
      var graph = {"nodes" : [], "links" : []};

      data.forEach(function (d) {
        graph.nodes.push({ "name": d.source,
                           "shortname": d.shortname });
        graph.nodes.push({ "name": d.target,
                           "shortname": d.shortname });
        if(init){
            if(d.target in tech_data){
                graph.links.push({ "source": d.source,
                               "target": d.target,
                               "endValue": +d.endval,
                               "value": +d.startval});
                tech_data[d.target].out_score = +d.startval;
            } else if(d.source in tech_data){
                graph.links.push({ "source": d.source,
                               "target": d.target,
                               "value": +d.startval,
                               "endValue": +d.endval });
                tech_data[d.source].in_score = +d.endval;
            } else {
                graph.links.push({ "source": d.source,
                   "target": d.target,
                   "endValue": +d.endval,
                   "value": +d.startval}); 
            }
        } else {
            if(d.target in tech_data){
                graph.links.push({ "source": d.source,
                               "target": d.target,
                               "endValue": +d.endval,
                               "value": +d.startval}); //tech_data[d.target].out_score});            
            } else if(d.source in tech_data){
                graph.links.push({ "source": d.source,
                               "target": d.target,
                               "value": +d.startval,
                               "endValue": tech_data[d.source].in_score});
            } else {
                graph.links.push({ "source": d.source,
                   "target": d.target,
                   "endValue": +d.endval,
                   "value": +d.startval});
            }
        }
       });

      graph.nodesNew = d3.nest()
         .key(function (d) { return d.name; })
         .rollup(function (d) { return d[0].shortname; }) // returns the shorname of the first element of that key
         .map(graph.nodes);

       // return only the distinct / unique nodes
      graph.nodes = d3.keys(d3.nest()
         .key(function (d) { return d.name; })
         .map(graph.nodes));


      // loop through each link replacing the text with its index from node
      graph.links.forEach(function (d, i) {
        graph.links[i].source = graph.nodes.indexOf(graph.links[i].source);
        graph.links[i].target = graph.nodes.indexOf(graph.links[i].target);
      });
        


      //now loop through each nodes to make nodes an array of objects
      // rather than an array of strings
      graph.nodes.forEach(function (d, i) {
        graph.nodes[i] = { "name": d,
                           "shortname": d };
      });
      return graph;
    }

    
    function get_blurb(tech, title){
        var titlekey = title.replace(/\s+/g, '-').toLowerCase() + "-blurb";
        var blurb = tech_more[tech_data[tech].short][titlekey];
        var split_blurb = blurb.split(" ");

        var result = "";
        var char_count = 0;
        for(var i = 0; i < split_blurb.length; i++){
            if(char_count > 30){
                result = result + "<br>";
                char_count = 0;
            }
            result = result + " "+split_blurb[i];
            char_count = char_count + split_blurb[i].length;
            //console.log(result);
        }
        return result;
    }
      
      
    tipLinks.html(function(d) {
      var title, tech;
      if (technologies.indexOf(d.source.name) > -1) {
        tech = d.source.name;
        title = d.target.name;
        var html =  '<div class="table-wrapper">'+
            '<h1>'+title+': '+tech+'</h1>'+
            '<table>'+
                '<tr>'+
                    '<td class="col-left">'+'</td>'+
                '</tr>'+
                '<tr>'+
                    '<td class="col-left" align="left">'+get_blurb(tech, title)+'</td>'+
                '</tr>'+
            '</table>'+
            '</div>';
      } else {
        tech = d.target.name;
        title = d.source.name;
        var html =  '<div class="table-wrapper">'+
            '<h1>'+title+': '+tech+'</h1>'+
            '<table>'+
                '<tr>'+
                    '<td class="col-left">'+'</td>'+
                '</tr>'+
                '<tr>'+
                    '<td class="col-left" align="left">'+get_blurb(tech, title)+'</td>'+
                '</tr>'+
            '</table>'+
            '</div>';
      }

      return html;
    });

    tipNodes.html(function(d) {
      var object = d3.entries(d),
          nodeName = object[0].value,
          linksTo = object[2].value,
          linksFrom = object[3].value,
          html;

      html =  '<div class="table-wrapper">'+
              '<h1>'+nodeName+'</h1>'+
              '<table>';
      if (linksFrom.length > 0 & linksTo.length > 0) {
        html+= '<tr><td><h2>Information Type:</h2></td><td></td></tr>'
      }
      for (i in linksFrom) {
        html += '<tr>'+
          '<td class="col-left">'+linksFrom[i].source.name+'</td>'+
          '<td align="right">'+formatAmount(linksFrom[i].value)+'</td>'+
        '</tr>';
      }
      if (linksFrom.length > 0 & linksTo.length > 0) {
        html+= '<tr><td><h2>Jurisdictions:</h2></td><td></td></tr>'
      }
      for (i in linksTo) {
        html += '<tr>'+
                  '<td class="col-left">'+linksTo[i].target.name+'</td>'+
                  '<td align="right">'+formatAmount(linksTo[i].value)+'</td>'+
                '</tr>';
      }
      html += '</table></div>';
      return html;
    });
      
    renderSankey(true);

    //the function for moving the nodes
    function dragmove(d) {
      d3.select(this).attr("transform", 
          "translate(" + d.x + "," + (
                  d.y = Math.max(0, Math.min(height - d.dy, d3.event.y))
              ) + ")");
      sankey.relayout();
      link.attr("d", path);
    }

    function hasLinks(node, links) {
      // checks if any links in links reference node
      l = false;
      links.forEach(function (d) {
        if (d.source == node || d.target == node) {
          l = true;
        }
      })
      return l;
    }

    d3.select('#spending-button').on('click', function () {
      d3.selectAll(".sankey-label").classed("clicked", false);
      d3.select(this).classed("clicked", true);
      currentData = data.filter(function (d) {
        return technologies.indexOf(d.source)+1;
      });
      renderSankey(false);
    });
    d3.select('#revenue-button').on('click', function () {
      d3.selectAll(".sankey-label").classed("clicked", false);
      d3.select(this).classed("clicked", true);
      currentData = data.filter(function (d) {
        return technologies.indexOf(d.target)+1;
      });
      renderSankey(false);
    });
    d3.select('#showall-button').on('click', function () {
      d3.selectAll(".sankey-label").classed("clicked", false);
      d3.select(this).classed("clicked", true);
      currentData = data;
      renderSankey(false);
    })

    function renderSankey(init) {
      d3.select('body').selectAll('g').remove();

      graph = processData(currentData, init);

      /*graph.links.forEach(function (d, i) {
            if(graph.nodes[d.source].name == "ALPR"){
                console.log(graph.nodes[d.source].name);
                graph.links[i].value = d3.select("#ALPRLevel").value;
            } 
        });*/
        
        
      myLinks = graph.links;
      myNodes = graph.nodes;


      svg = d3.select('.sankey')
          .attr("width", width+200)
          .attr("height", height)
        .append("g");


        
      sankey = d3.alluvialGrowth()
        .size([width, height])
        .nodes(myNodes)
        .links(myLinks)
        .layout(120);

      path = sankey.link();



      // add in the links
      link = svg.append("g").selectAll(".link")
          .data(myLinks)
        .enter().append("path")
          .attr("class", "link")
          .attr("d", path)
          //.attr('class', 'flowline')
          .style("stroke-width", function(d) { 
                return 0; //Math.max(1, d.dy);
           })
          .style("fill", function(d) {
            return getGradient(d);
           })
          .sort(function(a, b) { return b.dy - a.dy; })
          .on('mousemove', function(event) {
            tipLinks
              .style("top", (d3.event.pageY - linkTooltipOffset) + "px")
              .style("left", function () {
                var left = (Math.max(d3.event.pageX - linkTooltipOffset, 10)); 
                left = Math.min(left, window.innerWidth - $('.d3-tip').width() - 20)
                return left + "px"; })
            })
          .on('mouseover', tipLinks.show)
          .on('mouseout', tipLinks.hide);


     // add in the nodes
      node = svg.append("g").selectAll(".node")
          .data(myNodes)
        .enter().append("g")
          .attr("class", "node")
          .attr("transform", function(d) { 
              return "translate(" + d.x + "," + d.y + ")"; })
          .on('mousemove', function(event) {
            tipNodes
              .style("top", (d3.event.pageY - $('.d3-tip-nodes').height() - 20) + "px")
              .style("left", function () {
                var left = (Math.max(d3.event.pageX - nodeTooltipOffset, 10)); 
                left = Math.min(left, window.innerWidth - $('.d3-tip').width() - 20)
                return left + "px"; })
            })
          .on('mouseover', function(event){
            d3.select(this).style("cursor", "pointer");
            tipNodes.show(event);
          })
          .on('mouseout', tipNodes.hide)
        .call(d3.behavior.drag()
          .origin(function(d) { return d; })
          .on("dragstart", function() { 
              this.parentNode.appendChild(this); })
          .on("drag", dragmove))
            .on("mousedown", function(d){
               //console.log("CLIK!");
                if(d.name in tech_data){
                    showTechInfo(d.name);
                }
            });

      // add the rectangles for the nodes
      //node.append("rect")
          node.append("svg:image")
          .attr("height", function(d) { return d.dy; })
          .attr("width", function(d) { return d.dy; })
          .attr("xlink:href", function(d) {
            //console.log(d);
            if(d.name in tech_data){return tech_data[d.name].image;}
            return "img/node.png";
          })
  
          .attr("class", function(d) { 
            if (d.name == "Bernie Sanders" || d.name == "Hillary Clinton") { d.class = 'dem'; } 
            else if (technologies.indexOf(d.name) > 1) { d.class = 'rep'; } 
            else { d.class = 'none'; }
            return d.class; })
          .style("fill", function(d) {
            if(d.name in tech_data) tech_data[d.name].color;
            return "#CCCCCC";
          })
          .style("stroke", function(d) { 
		    return d3.rgb(d.color).darker(2); });
      
      if (true) {
        node.append("text")
            .attr("x", function(d) { return 6; })
            .attr("y", function(d) { return d.dy / 2; })
            .attr("dy", ".35em")
            .attr("text-anchor", "start")
            .attr("transform", null)
            .text(function(d) { return d.name; })
          .filter(function(d) { return d.x < width / 2; })
            .attr("x", function(d) { return 6;}) // + d.dy; })
            .attr("text-anchor", "start");
      } else {
        node.append("text")
            .attr("x", 6 + sankey.nodeWidth())
            .attr("y", function(d) { return d.dy / 2; })
            .attr("dy", ".35em")
            .attr("text-anchor", "start")
            .attr("transform", null)
            .text(function(d) { return d.name; })
          .filter(function(d) { return d.x < width / 2; })
            .attr("x", -6)
            .attr("text-anchor", "end");
      }
    }

    d3.select(window).on('resize.sankey', renderSankey(false));
      
    function getGradient(d) {
            var color = "#CCCCCC";
            var speed = "3s";
            var name = "undefined";
            if(d.source.name in tech_data){ 
                color = tech_data[d.source.name].color;
                speed = tech_data[d.source.name].speed;
                name = d.source.name;
                
            }
            if(d.target.name in tech_data){ 
                color = tech_data[d.target.name].color;
                speed = tech_data[d.target.name].speed;
                name = d.target.name;
            }
            name = name.replace(/\s/g,'');
            ////////////////////////////////////////////////////////////
            /////////////////// Animated gradient //////////////////////
            ////////////////////////////////////////////////////////////
            //var wrapper = d3.select("#sankey");
    var defs = svg.append("defs");
    var linearGradient = defs.append("linearGradient")
        .attr("id","animatedGradient"+name)
        .attr("x1","0%")
        .attr("y1","0%")
        .attr("x2","100%")
        .attr("y2","0")
        .attr("spreadMethod", "reflect");

    linearGradient.append("animate")
        .attr("attributeName","x1")
        .attr("values","0%;100%")
    //	.attr("from","0%")
    //	.attr("to","100%")
        .attr("dur",speed)
        .attr("repeatCount","indefinite");

    linearGradient.append("animate")
        .attr("attributeName","x2")
        .attr("values","100%;200%")
    //	.attr("from","100%")
    //	.attr("to","200%")
        .attr("dur",speed)
        .attr("repeatCount","indefinite");

    linearGradient.append("stop")
        .attr("offset","5%")
        .attr("stop-color","#FFFFFF");
    linearGradient.append("stop")
        .attr("offset","35%")
        .attr("stop-color",color);
    linearGradient.append("stop")
        .attr("offset","65%")
        .attr("stop-color",color);
    linearGradient.append("stop")
        .attr("offset","95%")
        .attr("stop-color","#FFFFFF");
     return "url(#animatedGradient"+name+")";
    }  
    
    function showTechInfo(name){
        document.getElementById("techinfo").innerHTML=tech_data[name].bio;
        document.getElementById("techinfo").style.display = 'block';
    }
      
    d3.select("#ALPRLevel").on("input", function() {
         tech_data["ALPR"].in_score = +this.value;
         renderSankey(false);
		});

  });
</script>
</body>
</html>